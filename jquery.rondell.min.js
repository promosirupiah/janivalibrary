/*!
jQuery rondell plugin
@name jquery.rondell.js
@author Sebastian Helzle (sebastian@helzle.net or @sebobo)
@version 1.0.4
@date 2013-07-19
@category jQuery plugin
@copyright (c) 2009-2013 Sebastian Helzle (www.sebastianhelzle.net)
@license Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
*/
var __bind=function(a,b){return function(){return a.apply(b,arguments)}};!function(a){var b,c,d,e,f,g,h,i,j,k,l,m;return a.rondell||(a.rondell={version:"1.0.4",name:"rondell",lightbox:{instance:void 0,template:a.trim('        <div class="rondell-lightbox">          <div class="rondell-lightbox-overlay">&nbsp;</div>          <div class="rondell-lightbox-content">            <div class="rondell-lightbox-inner"/>            <div class="rondell-lightbox-close">&Chi;</div>            <div class="rondell-lightbox-prev">&nbsp;</div>            <div class="rondell-lightbox-position">1</div>            <div class="rondell-lightbox-next">&nbsp;</div>          </div>        </div>')},defaults:{showContainer:!0,classes:{container:"rondell-container",initializing:"rondell-initializing",themePrefix:"rondell-theme",caption:"rondell-caption",noScale:"no-scale",item:"rondell-item",image:"rondell-item-image",resizeable:"rondell-item-resizeable",small:"rondell-item-small",hidden:"rondell-item-hidden",loading:"rondell-item-loading",hovered:"rondell-item-hovered",overlay:"rondell-item-overlay",focused:"rondell-item-focused",crop:"rondell-item-crop",error:"rondell-item-error",control:"rondell-control",shiftLeft:"rondell-shift-left",shiftRight:"rondell-shift-right"},currentLayer:0,container:null,radius:{x:250,y:50},center:{left:340,top:160},size:{width:null,height:null},visibleItems:"auto",scaling:2,opacityMin:.05,fadeTime:300,keyDelay:300,zIndex:1e3,itemProperties:{delay:100,size:{width:150,height:150},sizeFocused:{width:0,height:0}},lightbox:{enabled:!0,displayReferencedImages:!0},imageFiletypes:["png","jpg","jpeg","gif","bmp"],repeating:!0,wrapIndices:!0,switchIndices:!1,alwaysShowCaption:!1,captionsEnabled:!0,autoRotation:{enabled:!1,paused:!1,direction:0,once:!1,delay:5e3},controls:{enabled:!0,fadeTime:400,margin:{x:130,y:270}},strings:{prev:"prev",next:"next",loadingError:"An error occured while loading <b>%s</b>",more:"More..."},mousewheel:{enabled:!0,threshold:0,minTimeBetweenShifts:500},touch:{enabled:!0,preventDefaults:!0,threshold:100},randomStart:!1,funcEase:"easeInOutQuad",theme:"default",preset:"",effect:null,onAfterShift:null,onUpdateLightbox:null,cropThumbnails:!1,scrollbar:{enabled:!1,orientation:"bottom",start:1,end:100,stepSize:1,keepStepOrder:!0,position:1,padding:10,style:{width:"100%",height:20,left:"auto",right:"auto",top:"auto",bottom:"auto"},repeating:!1,onScroll:void 0,scrollOnHover:!1,scrollOnDrag:!0,animationDuration:300,easing:"easeInOutQuad",classes:{container:"rondell-scrollbar",control:"rondell-scrollbar-control",dragging:"rondell-scrollbar-dragging",background:"rondell-scrollbar-background",scrollLeft:"rondell-scrollbar-left",scrollRight:"rondell-scrollbar-right",scrollInner:"rondell-scrollbar-inner"}}}}),(m=a.easing).easeInOutQuad||(m.easeInOutQuad=function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c}),f=function(a,b){return setTimeout(b,a)},c=a(window),b=a(document),d=function(){function d(b,c,e,f){var g,h;null==f&&(f=void 0),this.showLightbox=__bind(this.showLightbox,this),this.keyDown=__bind(this.keyDown,this),this.isFocused=__bind(this.isFocused,this),this.onWindowBlur=__bind(this.onWindowBlur,this),this.onWindowFocus=__bind(this.onWindowFocus,this),this._autoShift=__bind(this._autoShift,this),this._autoShiftInit=__bind(this._autoShiftInit,this),this.shiftRight=__bind(this.shiftRight,this),this.shiftLeft=__bind(this.shiftLeft,this),this._refreshControls=__bind(this._refreshControls,this),this.getIndexInRange=__bind(this.getIndexInRange,this),this.getRelativeItemPosition=__bind(this.getRelativeItemPosition,this),this.shiftTo=__bind(this.shiftTo,this),this._hover=__bind(this._hover,this),this._onTouch=__bind(this._onTouch,this),this._onMousewheel=__bind(this._onMousewheel,this),this.bindEvents=__bind(this.bindEvents,this),this._start=__bind(this._start,this),this.onItemInit=__bind(this.onItemInit,this),this._loadItem=__bind(this._loadItem,this),this._getItem=__bind(this._getItem,this),this._onMouseLeaveItem=__bind(this._onMouseLeaveItem,this),this._onMouseEnterItem=__bind(this._onMouseEnterItem,this),this.fitToContainer=__bind(this.fitToContainer,this),this.id=++d.rondellCount,this.items=[],this.maxItems=e,this.loadedItems=0,this.initCallback=f,1===this.id&&(d.activeRondell=this.id),(null!=c?c.preset:void 0)in a.rondell.presets?a.extend(!0,this,a.rondell.defaults,a.rondell.presets[c.preset],c||{}):a.extend(!0,this,a.rondell.defaults,c||{}),a.extend(!0,this,{_dimensions:{computed:!1},_lastKeyEvent:0,_windowFocused:!0,_focusedIndex:this.currentLayer,_itemIndices:{0:0},autoRotation:{_timer:-1},controls:{_lastShift:0},touch:{_start:void 0,_end:void 0},scrollbar:{_instance:null}}),this.itemProperties.sizeFocused={width:this.itemProperties.sizeFocused.width||this.itemProperties.size.width*this.scaling,height:this.itemProperties.sizeFocused.height||this.itemProperties.size.height*this.scaling},this.size={width:this.size.width||2*this.center.left,height:this.size.height||2*this.center.top},g=a("<div/>").css(this.size).addClass(""+this.classes.initializing+" "+this.classes.container+" "+this.classes.themePrefix+"-"+this.theme),this.container=b.wrapAll(g).parent().addClass("rondell-instance-"+this.id).data("api",this),this.showContainer&&this.container.parent().show(),this.scrollbar.enabled&&(h=a("<div/>"),this.container.append(h),a.extend(!0,this.scrollbar,{onScroll:this.shiftTo,end:this.maxItems,position:this.currentLayer,repeating:this.repeating}),this.scrollbar._instance=new a.rondell.RondellScrollbar(h,this.scrollbar))}return d.rondellCount=0,d.activeRondell=null,d.prototype.log=function(a){return"undefined"!=typeof console&&null!==console?console.log(a):void 0},d.prototype.equals=function(a,b){var c,d;for(c in a)if(d=a[c],b[c]!==d)return!1;for(c in b)if(d=b[c],a[c]!==d)return!1;return!0},d.prototype.funcLeft=function(a,b){return b.center.left-b.itemProperties.size.width/2+Math.sin(a)*b.radius.x},d.prototype.funcTop=function(a,b){return b.center.top-b.itemProperties.size.height/2+Math.cos(a)*b.radius.y},d.prototype.funcDiff=function(a,b){return Math.pow(Math.abs(a)/b.maxItems,.5)*Math.PI},d.prototype.funcOpacity=function(a,b){return b.visibleItems>1?Math.max(0,1-Math.pow(a/b.visibleItems,2)):0},d.prototype.funcSize=function(){return 1},d.prototype.fitToContainer=function(){var b,c,d,e,f;return f=this.container.parent(),c=f.innerWidth(),b=f.innerHeight(),this._dimensions.computed||(e=this.size.width,d=this.size.height,a.extend(!0,this._dimensions,{computed:!0,center:{left:this.center.left/e,top:this.center.top/d},radius:{x:this.radius.x/e,y:this.radius.y/d},controls:{margin:{x:this.controls.margin.x/e,y:this.controls.margin.y/d}},itemProperties:{size:{width:this.itemProperties.size.width/e,height:this.itemProperties.size.height/d},sizeFocused:{width:this.itemProperties.sizeFocused.width/e,height:this.itemProperties.sizeFocused.height/d}}})),a.extend(!0,this,{size:{width:c,height:b},center:{left:this._dimensions.center.left*c,top:this._dimensions.center.top*b},radius:{x:this._dimensions.radius.x*c,y:this._dimensions.radius.y*b},controls:{margin:{x:this._dimensions.controls.margin.x*c,y:this._dimensions.controls.margin.y*b}},itemProperties:{size:{width:this._dimensions.itemProperties.size.width*c,height:this._dimensions.itemProperties.size.height*b},sizeFocused:{width:this._dimensions.itemProperties.sizeFocused.width*c,height:this._dimensions.itemProperties.sizeFocused.height*b}}}),this.container.css(this.size),this.shiftTo(this.currentLayer)},d.prototype._onMouseEnterItem=function(a){return this._getItem(a).onMouseEnter()},d.prototype._onMouseLeaveItem=function(a){return this._getItem(a).onMouseLeave()},d.prototype._getItem=function(a){return this.items[a-1]},d.prototype._loadItem=function(b,c){var d;return d=new a.rondell.RondellItem(b,c,this),this.items[b-1]=d,this._itemIndices[b]=b,d.init(),++this.loadedItems===this.maxItems?this._start():void 0},d.prototype.onItemInit=function(a){var b;return b=this._getItem(a),a===this.currentLayer?b.prepareFadeIn():b.prepareFadeOut(),b.runAnimation(!0)},d.prototype._start=function(){var b;return this.currentLayer=this.randomStart?Math.round(Math.random()*(this.maxItems-1)):Math.max(0,Math.min(this.currentLayer||Math.round(this.maxItems/2),this.maxItems)),"auto"===this.visibleItems&&(this.visibleItems=Math.max(2,~~(this.maxItems/2))),b=this.controls,b.enabled&&(this.controls._shiftLeft=a('<a href="#/"/>').addClass(""+this.classes.control+" "+this.classes.shiftLeft).html(this.strings.prev).click(this.shiftLeft).css({left:b.margin.x,top:b.margin.y,zIndex:this.zIndex+this.maxItems+2}),this.controls._shiftRight=a('<a href="#/"/>').addClass(""+this.classes.control+" "+this.classes.shiftRight).html(this.strings.next).click(this.shiftRight).css({right:b.margin.x,top:b.margin.y,zIndex:this.zIndex+this.maxItems+2}),this.container.append(this.controls._shiftLeft,this.controls._shiftRight)),this.bindEvents(),this.container.removeClass(this.classes.initializing),"function"==typeof this.initCallback&&this.initCallback(this),null==this._focusedItem&&(this._focusedItem=this._getItem(this.currentLayer)),this.shiftTo(this.currentLayer)},d.prototype.bindEvents=function(){var d;return b.keydown(this.keyDown),c.blur(this.onWindowBlur).focus(this.onWindowFocus),b.focusout(this.onWindowBlur).focusin(this.onWindowFocus),this.mousewheel.enabled&&null!=a.fn.mousewheel&&this.container.bind("mousewheel.rondell",this._onMousewheel),this._onMobile()?this.touch.enabled&&this.container.bind("touchstart.rondell touchmove.rondell touchend.rondell",this._onTouch):this.container.bind("mouseenter.rondell mouseleave.rondell",this._hover),d=this,this.container.delegate("."+this.classes.item,"click.rondell",function(b){var c;if(c=a(this).data("item"),d._focusedItem.id===c.id){if(d.lightbox.enabled)return b.preventDefault(),d.showLightbox()}else if(b.preventDefault(),!c.hidden&&c.object.is(":visible"))return d.shiftTo(c.currentSlot)}).delegate("."+this.classes.item,"mouseenter.rondell mouseleave.rondell",function(b){var c;return c=a(this).data("item"),"mouseenter"===b.type?d._onMouseEnterItem(c.id):d._onMouseLeaveItem(c.id)})},d.prototype._onMobile=function(){return"undefined"!=typeof Modernizr&&null!==Modernizr?Modernizr.touch:void 0},d.prototype._onMousewheel=function(a,b,d){var e,f,g,h;if(this.mousewheel.enabled&&this.isFocused()&&(e=(new Date).getTime(),!(e-this.mousewheel._lastShift<this.mousewheel.minTimeBetweenShifts)))return h=c.scrollTop(),g=h+c.height(),f=this.container.offset().top+this.container.outerHeight()/2,f>h&&g>f&&Math.abs(d)>this.mousewheel.threshold?(a.preventDefault(),0>d?this.shiftLeft():this.shiftRight(),this.mousewheel._lastShift=e):void 0},d.prototype._onTouch=function(a){var b,c;if(this.touch.enabled){switch(c=a.originalEvent.touches[0]||a.originalEvent.changedTouches[0],a.type){case"touchstart":this.touch._start={x:c.pageX,y:c.pageY};break;case"touchmove":this.touch.preventDefaults&&a.preventDefault(),this.touch._end={x:c.pageX,y:c.pageY};break;case"touchend":this.touch._start&&this.touch._end&&(b=this.touch._end.x-this.touch._start.x,Math.abs(b)>this.touch.threshold&&(b>0?this.shiftLeft():0>b&&this.shiftRight()),this.touch._start=this.touch._end=void 0)}return!0}},d.prototype._hover=function(a){var b;return b=this.autoRotation.paused,"mouseenter"===a.type?(d.activeRondell=this.id,this.hovering=!0,b||(this.autoRotation.paused=!0,this._focusedItem.showCaption())):(this.hovering=!1,b&&!this.autoRotation.once&&(this.autoRotation.paused=!1,this._autoShiftInit()),this.alwaysShowCaption||this._focusedItem.hideCaption()),this.controls.enabled?this._refreshControls():void 0},d.prototype.shiftTo=function(a,b){var c,d,e,f,g,h,j,k,l,m,n,o,p;if(null==b&&(b=!1),null!=a){for(!b&&this.switchIndices&&a!==this.currentLayer&&this.getIndexInRange(a)===this._focusedItem.currentSlot&&(n=this.getRelativeItemPosition(a,!0),c=n[0],g=n[1],g>this.currentLayer?a++:a--),a=this.getIndexInRange(a),f=this._itemIndices[a],e=this._getItem(f),this.switchIndices&&(this._itemIndices[a]=this._focusedItem.id,this._itemIndices[this._focusedItem.currentSlot]=f,e.currentSlot=this._focusedItem.currentSlot,this._focusedItem.currentSlot=a),this._focusedItem=e,this.currentLayer=a,this._focusedItem.prepareFadeIn(),o=this.items,j=0,l=o.length;l>j;j++)d=o[j],d!==this._focusedItem&&d.prepareFadeOut();for(p=this.items,k=0,m=p.length;m>k;k++)d=p[k],d.runAnimation();return this._autoShiftInit(),this._refreshControls(),this.lightbox.enabled&&i()&&this.showLightbox(),this.scrollbar.enabled&&(h=a,a===this._focusedItem.currentSlot&&(h=this._focusedItem.currentSlot+1),this.scrollbar._instance.setPosition(h,!1)),"function"==typeof this.onAfterShift?this.onAfterShift(a):void 0}},d.prototype.getRelativeItemPosition=function(a,b){var c,d;return null==b&&(b=this.wrapIndices),c=Math.abs(a-this.currentLayer),d=a,c>this.visibleItems&&c>this.maxItems/2&&this.repeating&&b&&(a>this.currentLayer?d-=this.maxItems:d+=this.maxItems,c=Math.abs(d-this.currentLayer)),[c,d]},d.prototype.getIndexInRange=function(a){return this.repeating?1>a?a+=this.maxItems:a>this.maxItems&&(a-=this.maxItems):1>a?a=1:a>this.maxItems&&(a=this.maxItems),a},d.prototype._refreshControls=function(){return this.controls.enabled?(this.controls._shiftLeft.stop().fadeTo(this.controls.fadeTime,(this.currentLayer>1||this.repeating)&&this.hovering?1:0),this.controls._shiftRight.stop().fadeTo(this.controls.fadeTime,(this.currentLayer<this.maxItems||this.repeating)&&this.hovering?1:0)):void 0},d.prototype.shiftLeft=function(a){return null!=a&&a.preventDefault(),this.shiftTo(this.currentLayer-1)},d.prototype.shiftRight=function(a){return null!=a&&a.preventDefault(),this.shiftTo(this.currentLayer+1)},d.prototype._autoShiftInit=function(){var a;return a=this.autoRotation,this.isActive()&&a.enabled&&a._timer<0?a._timer=window.setTimeout(this._autoShift,a.delay):void 0},d.prototype._autoShift=function(){return this.autoRotation._timer=-1,this.isActive()&&this.isFocused()&&!i()&&!this.autoRotation.paused?this.autoRotation.direction?this.shiftRight():this.shiftLeft():this._autoShiftInit()},d.prototype.onWindowFocus=function(){return this._windowFocused=!0},d.prototype.onWindowBlur=function(){return this._windowFocused=!1},d.prototype.isActive=function(){return!0},d.prototype.isFocused=function(){return this._windowFocused&&d.activeRondell===this.id},d.prototype.keyDown=function(a){var b,c;if(this.isActive()&&this.isFocused()&&(c=(new Date).getTime(),!(this._lastKeyEvent>c-this.keyDelay)))switch(this.autoRotation._timer>=0&&(window.clearTimeout(this.autoRotation._timer),this.autoRotation._timer=-1),this._lastKeyEvent=c,b=a.which||a.keyCode){case 37:return this.shiftLeft(a);case 39:return this.shiftRight(a);case 27:return e()}},d.prototype.showLightbox=function(){var b,c,d=this;return b=h(),c=a(".rondell-lightbox-content",b),i()||b.add(c).css("visibility","hidden"),c.stop().fadeTo(100,0,function(){var b,e,f,g,h,i,j,k,m;if(e=a(".rondell-lightbox-inner",c).html(d._focusedItem.object.html()),a(".rondell-lightbox-position").text(""+d.currentLayer+" | "+d.maxItems),a("."+d.classes.overlay,e).style="",d._focusedItem.isLink&&(i=d._focusedItem.object.attr("href"),h=d._focusedItem.object.attr("target"),a("."+d.classes.caption,e).append("<a href='"+i+"' target='"+h+"'>"+d.strings.more+"</a>").attr("style","")),f=a("."+d.classes.image,e),f&&d._focusedItem.referencedImage){for(m=["style","width","height"],j=0,k=m.length;k>j;j++)b=m[j],f.removeAttr(b);f[0].src=d._focusedItem.referencedImage}return f&&!f[0].complete?(g=a('<img style="display:none"/>'),c.append(d.iconCopy),g.one("load",l)[0].src=d._focusedItem.referencedImage):setTimeout(l,0)})},d}(),g=function(){return a(".rondell-instance-"+d.activeRondell).data("api")},k=0,j=function(){return clearTimeout(k),i()?k=setTimeout(l,200):void 0},i=function(){var b;return null!=(b=a.rondell.lightbox.instance)?b.is(":visible"):void 0},e=function(){return i()?h().stop().fadeOut(150):void 0},h=function(){var b;return a.rondell.lightbox.instance||(b=a.rondell.lightbox.instance=a(a.rondell.lightbox.template).appendTo(a("body")),a(".rondell-lightbox-overlay, .rondell-lightbox-close",b).bind("click.rondell",e),a(".rondell-lightbox-prev",b).bind("click.rondell",function(){return g().shiftLeft()}),a(".rondell-lightbox-next",b).bind("click.rondell",function(){return g().shiftRight()}),c.bind("resize.rondell",j),b.bind("mousewheel.rondell",function(a,b,c,d){return g()._onMousewheel(a,b,c,d)})),a.rondell.lightbox.instance},l=function(){var b,d,e,f,i,j,k,l,m,n,o,p,q,r,s,t,u;return b=h(),d=a(".rondell-lightbox-content",b),t=c.innerWidth(),s=c.innerHeight(),u=20,e=g(),f=e._focusedItem,b.css("display","block"),i=a("img:first",d),i.length&&(f.lightboxImageWidth||(f.lightboxImageWidth=i[0].width,f.lightboxImageHeight=i[0].height,i.attr("width",f.lightboxImageWidth).attr("height",f.lightboxImageHeight)),l=f.lightboxImageWidth,k=f.lightboxImageHeight,j=l/k,n=t-2*u,m=s-2*u,l>n&&(l=n,k=l/j),k>m&&(k=m,l=k*j),i.css({width:l,height:k})),b.add(d).css("visibility","visible"),q=d.outerWidth(),o=d.outerHeight(),p={marginLeft:-q/2,top:Math.max((s-o)/2,20)},r=function(){return"function"==typeof e.onUpdateLightbox?e.onUpdateLightbox(f):void 0},d.css("opacity")<1?d.css(p).fadeTo(200,1,r):(p.opacity=1,d.animate(p,200,r)),b.stop().fadeTo(150,1)},a.fn.rondell=function(b,c){var e;return null==b&&(b={}),null==c&&(c=void 0),e=new d(this,b,this.length,c),this.each(function(b){return e._loadItem(b+1,a(this))}),e}}(jQuery),function(a){return a.rondell||(a.rondell={}),a.rondell.presets={carousel:{autoRotation:{enabled:!0,direction:1,once:!1,delay:5e3},radius:{x:240,y:50},center:{left:340,top:160},controls:{margin:{x:130,y:260}},randomStart:!0,currentLayer:1,funcSize:function(a){return 1/Math.abs(a)}},scroller:{repeating:!1,alwaysShowCaption:!0,visibleItems:4,theme:"dark",lightbox:{enabled:!1},itemProperties:{delay:0,size:{width:100,height:200},sizeFocused:{width:300,height:200}},center:{left:400,top:100},size:{width:800,height:200},controls:{margin:{x:210,y:158}},funcTop:function(){return 0},funcDiff:function(a){return Math.abs(a)+1},funcLeft:function(a,b){return b.center.left+(a-.5)*b.itemProperties.size.width},funcOpacity:function(){return.8}},pages:{radius:{x:0,y:0},lightbox:{enabled:!1},scaling:1,theme:"page",visibleItems:1,controls:{margin:{x:0,y:0}},strings:{prev:" ",next:" "},center:{left:200,top:200},itemProperties:{size:{width:400,height:400}},funcTop:function(a,b){return b.center.top-b.itemProperties.size.height/2},funcLeft:function(a,b){return b.center.left+a*b.itemProperties.size.width},funcDiff:function(a){return Math.abs(a)+.5}},cubic:{center:{left:300,top:200},visibleItems:5,itemProperties:{size:{width:350,height:350},sizeFocused:{width:350,height:350}},controls:{margin:{x:70,y:330}},funcTop:function(a,b){return b.center.top-b.itemProperties.size.height/2+Math.pow(a/2,3)*b.radius.x},funcLeft:function(a,b){return b.center.left-b.itemProperties.size.width/2+Math.sin(a)*b.radius.x},funcSize:function(a){return Math.pow((Math.PI-Math.abs(a))/Math.PI,3)}},gallery:{special:{itemPadding:2},visibleItems:5,theme:"dark",cropThumbnails:!0,center:{top:145,left:250},size:{height:400,width:500},controls:{margin:{x:10,y:255}},itemProperties:{delay:0,sizeFocused:{width:480,height:280},size:{width:80,height:100}},funcTop:function(a,b){return b.size.height-b.itemProperties.size.height-b.special.itemPadding},funcDiff:function(a){return Math.abs(a)-.5},funcLeft:function(a,b){return b.center.left+(a-.5)*(b.itemProperties.size.width+b.special.itemPadding)},funcOpacity:function(){return.8}},thumbGallery:{special:{columns:3,rows:3,groupSize:9,itemPadding:5,thumbsOffset:{x:500,y:0}},visibleItems:9,wrapIndices:!1,currentLayer:1,switchIndices:!0,cropThumbnails:!0,center:{top:215,left:250},size:{height:430,width:800},controls:{enabled:!1,margin:{x:10,y:255}},itemProperties:{delay:40,sizeFocused:{width:480,height:420},size:{width:94,height:126}},scrollbar:{enabled:!0,stepSize:9,start:2,style:{width:292,right:3,bottom:5}},funcDiff:function(a){return Math.abs(a)},funcOpacity:function(a,b,c){var d;return d=b.currentLayer>b._focusedItem.currentSlot?b.currentLayer-1:b.currentLayer,c>b._focusedItem.currentSlot&&c--,Math.floor((c-1)/b.special.groupSize)===Math.floor((d-1)/b.special.groupSize)?.8:0},funcTop:function(a,b,c){return c>b._focusedItem.currentSlot&&c--,b.special.thumbsOffset.y+b.special.itemPadding+Math.floor((c-1)%b.special.groupSize/b.special.rows)*(b.itemProperties.size.height+b.special.itemPadding)},funcLeft:function(a,b,c){var d,e,f;return e=b.currentLayer>b._focusedItem.currentSlot?b.currentLayer-1:b.currentLayer,c>b._focusedItem.currentSlot&&c--,d=(c-1)%b.special.groupSize%b.special.columns,f=Math.floor((c-1)/b.special.groupSize)-Math.floor((e-1)/b.special.groupSize),b.special.thumbsOffset.x+b.special.itemPadding+(d+b.special.columns*f)*(b.itemProperties.size.width+b.special.itemPadding)}},slider:{theme:"slider",visibleItems:1,fadeTime:1e3,opacityMin:.01,autoRotation:{enabled:!0},center:{top:150,left:300},size:{height:300,width:600},controls:{margin:{x:-1,y:135}},strings:{prev:"<span>&nbsp;</span>",next:"<span>&nbsp;</span>"},itemProperties:{sizeFocused:{width:600,height:300},size:{width:600,height:300}},funcTop:function(){return 0},funcLeft:function(){return 0},funcOpacity:function(){return.02}}}}(jQuery);var __bind=function(a,b){return function(){return a.apply(b,arguments)}};!function(a){return a.rondell||(a.rondell={}),a.rondell.RondellScrollbar=function(){function b(b,c){this.scrollRight=__bind(this.scrollRight,this),this.scrollLeft=__bind(this.scrollLeft,this),this.onScrollbarClick=__bind(this.onScrollbarClick,this),this.onDragStart=__bind(this.onDragStart,this),this.onDrag=__bind(this.onDrag,this),this.setPosition=__bind(this.setPosition,this),this.scrollTo=__bind(this.scrollTo,this),this.updatePosition=__bind(this.updatePosition,this),this._initControls=__bind(this._initControls,this),a.extend(!0,this,a.rondell.defaults.scrollbar,c),this.container=b.addClass(this.classes.container),this._drag={_dragging:!1,_lastDragEvent:0},this.container.addClass(""+this.classes.container+"-"+this.orientation).css(this.style),this._initControls(),this._minX=this.padding+this.scrollLeftControl.outerWidth()+this.scrollControl.outerWidth()/2,this._maxX=this.container.innerWidth()-this.padding-this.scrollRightControl.outerWidth()-this.scrollControl.outerWidth()/2,this.setPosition(this.position,!1,!0)}return b.prototype._initControls=function(){var b;return b='<div><span class="'+this.classes.scrollInner+'">&nbsp;</span></div>',this.scrollLeftControl=a(b).addClass(this.classes.scrollLeft).click(this.scrollLeft),this.scrollRightControl=a(b).addClass(this.classes.scrollRight).click(this.scrollRight),this.scrollControl=a('<div class="'+this.classes.control+'">&nbsp;</div>').css("left",this.container.innerWidth()/2).mousedown(this.onDragStart),this.scrollBackground=a('<div class="'+this.classes.background+'"/>'),this.container.append(this.scrollBackground,this.scrollLeftControl,this.scrollRightControl,this.scrollControl),this.container.add(this.scrollBackground).click(this.onScrollbarClick)},b.prototype.updatePosition=function(a,b){return null==b&&(b=!0),!a||a===this.position||a<this.start||a>this.end?void 0:(this.position=a,b?"function"==typeof this.onScroll?this.onScroll(a,!0):void 0:void 0)},b.prototype.scrollTo=function(a,b,c){var d,e,f;return null==b&&(b=!0),null==c&&(c=!0),a<this._minX||a>this._maxX?void 0:(e=this.scrollControl.stop(!0),f={left:a},b?e.animate(f,this.animationDuration,this.easing):e.css(f),d=Math.round((a-this._minX)/(this._maxX-this._minX)*(this.end-this.start))+this.start,d!==this.position?this.updatePosition(d,c):void 0)},b.prototype.setPosition=function(a,b,c){var d;return null==b&&(b=!0),null==c&&(c=!1),this.repeating&&(a<this.start&&(a=this.end),a>this.end&&(a=this.start)),c||!(a<this.start||a>this.end||a===this.position)?(d=Math.round((a-this.start)/(this.end-this.start)*(this._maxX-this._minX))+this._minX,this.scrollTo(d,!0,b)):void 0},b.prototype.onDrag=function(b){var c,d;return b.preventDefault(),this._drag._dragging?"mouseup"===b.type?(this._drag._dragging=!1,this.scrollControl.removeClass(this.classes.dragging),a(window).unbind("mousemove mouseup",this.onDrag)):(c=0,c="top"===(d=this.orientation)||"bottom"===d?b.pageX-this.container.offset().left:b.pageY-this.container.offset().top,c=Math.max(this._minX,Math.min(this._maxX,c)),this.scrollTo(c,!1)):void 0},b.prototype.onDragStart=function(b){return b.preventDefault(),this._drag._dragging=!0,this.scrollControl.addClass(this.classes.dragging),a(window).bind("mousemove mouseup",this.onDrag)},b.prototype.onScrollbarClick=function(a){return this.scrollTo(a.pageX-this.container.offset().left)},b.prototype.scrollLeft=function(a){var b;return a.preventDefault(),b=this.position-this.stepSize,this.keepStepOrder&&this.stepSize>1&&(b>=this.start?b-=(b-this.start)%this.stepSize:this.repeating&&(b=this.start+Math.floor((this.end-this.start)/this.stepSize)*this.stepSize)),this.setPosition(b)},b.prototype.scrollRight=function(a){var b;return a.preventDefault(),b=this.position+this.stepSize,this.keepStepOrder&&this.stepSize>1&&(b-=(b-this.start)%this.stepSize,this.repeating&&b>this.end&&(b=this.start)),this.setPosition(b)},b}()}(jQuery);var __bind=function(a,b){return function(){return a.apply(b,arguments)}};!function(a){return a.rondell||(a.rondell={}),a.rondell.RondellItem=function(){function b(a,b,c){this.id=a,this.object=b,this.rondell=c,this.runAnimation=__bind(this.runAnimation,this),this.onAnimationFinished=__bind(this.onAnimationFinished,this),this.prepareFadeOut=__bind(this.prepareFadeOut,this),this.prepareFadeIn=__bind(this.prepareFadeIn,this),this.hideCaption=__bind(this.hideCaption,this),this.showCaption=__bind(this.showCaption,this),this.onMouseLeave=__bind(this.onMouseLeave,this),this.onMouseEnter=__bind(this.onMouseEnter,this),this.finalize=__bind(this.finalize,this),this.onError=__bind(this.onError,this),this.onIconLoad=__bind(this.onIconLoad,this),this.refreshDimensions=__bind(this.refreshDimensions,this),this.init=__bind(this.init,this),this.currentSlot=this.id,this.focused=!1,this.hidden=!1,this.animating=!1,this.isNew=!0,this.icon=null,this.resizeable=!0,this.iconCopy=null,this.croppedSize=this.rondell.itemProperties.size,this.sizeSmall=this.rondell.itemProperties.size,this.sizeFocused=this.rondell.itemProperties.sizeFocused,this.objectCSSTarget={},this.objectAnimationTarget={},this.lastObjectAnimationTarget={},this.iconAnimationTarget={},this.lastIconAnimationTarget={},this.animationSpeed=this.rondell.fadeTime,this.isLink=this.object.is("a"),this.referencedImage=null}return b.prototype.init=function(){var b,c,d,e,f,g,h;if(this.object.is("img")&&(this.object=this.object.wrap("<div/>").parent()),this.object.addClass(""+this.rondell.classes.item).data("item",this).css({opacity:0,width:this.sizeSmall.width,height:this.sizeSmall.height,left:this.rondell.center.left-this.sizeFocused.width/2,top:this.rondell.center.top-this.sizeFocused.height/2}),this.isLink&&this.rondell.lightbox.displayReferencedImages)for(e=this.object.attr("href"),d=this._getFiletype(e),h=this.rondell.imageFiletypes,f=0,g=h.length;g>f;f++)if(b=h[f],d===b){this.referencedImage=e;break}return c=this.object.find("img:first"),c.length?(this.icon=c,this.resizeable=!c.hasClass(this.rondell.classes.noScale),this.icon.addClass(this.rondell.classes.image),this.object.addClass(this.rondell.classes.loading),c.width()>0||c[0].complete&&c[0].width>0?window.setTimeout(this.onIconLoad,10):(this.iconCopy=a('<img style="display:none"/>'),a("body").append(this.iconCopy),this.iconCopy.one("load",this.onIconLoad).one("error",this.onError).attr("src",c.attr("src")))):this.finalize()},b.prototype._getFiletype=function(a){return a.substr(a.lastIndexOf(".")+1).toLowerCase()},b.prototype.refreshDimensions=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o;return g=(null!=(k=this.iconCopy)?k.width():void 0)||(null!=(l=this.iconCopy)?l[0].width:void 0)||this.icon[0].width||this.icon.width(),f=(null!=(m=this.iconCopy)?m.height():void 0)||(null!=(n=this.iconCopy)?n[0].height:void 0)||this.icon[0].height||this.icon.height(),d=j=g,c=i=f,h=this.rondell.itemProperties.size,e=this.rondell.itemProperties.sizeFocused,b=h,null!=(o=this.iconCopy)&&o.remove(),g&&f?(this.resizeable?(this.icon.addClass(this.rondell.classes.resizeable),i*=h.width/j,j=h.width,i>h.height&&(j*=h.height/i,i=h.height),this.rondell.cropThumbnails&&(this.icon.parent().hasClass(this.rondell.classes.crop)||this.icon.wrap(a("<div>").addClass(this.rondell.classes.crop)),b={width:h.width,height:h.width/j*i},b.height<h.height&&(b={width:h.height/b.height*b.width,height:h.height}),j=h.width,i=h.height),c*=e.width/d,d=e.width,c>e.height&&(d*=e.height/c,c=e.height)):(j=h.width,i=h.height,d=e.width,c=e.height),this.croppedSize=b,this.iconWidth=g,this.iconHeight=f,this.sizeSmall={width:Math.round(j),height:Math.round(i)},this.sizeFocused={width:Math.round(d),height:Math.round(c)}):void 0},b.prototype.onIconLoad=function(){return this.refreshDimensions(),this.finalize()},b.prototype.onError=function(){var a,b;return a=this.rondell.strings.loadingError.replace("%s",this.icon.attr("src")),this.icon.remove(),null!=(b=this.iconCopy)&&b.remove(),this.object.removeClass(this.rondell.classes.loading).addClass(this.rondell.classes.error).html("<p>"+a+"</p>")},b.prototype.finalize=function(){var b,c,d,e,f,g,h;return this.object.removeClass(this.rondell.classes.loading),this.rondell.captionsEnabled&&(c=null,c=this.rondell.cropThumbnails?null!=(e=this.icon)?e.closest("."+this.rondell.classes.crop).siblings():void 0:null!=(f=this.icon)?f.siblings():void 0,(null!=c?c.length:void 0)||this.icon||!this.object.children().length||(c=this.object.children()),(null!=c?c.length:void 0)||(b=this.object.attr("title")||(null!=(g=this.icon)?g.attr("title"):void 0)||(null!=(h=this.icon)?h.attr("alt"):void 0),b&&(c=a("<p>"+b+"</p>"),this.object.append(c))),(null!=c?c.length:void 0)&&(d=c.wrapAll("<div/>").parent().addClass(this.rondell.classes.caption),this.icon&&(this.overlay=d.addClass(this.rondell.classes.overlay)))),this.rondell.onItemInit(this.id)},b.prototype.onMouseEnter=function(){return this.animating||this.hidden||!this.object.is(":visible")?void 0:this.object.addClass(this.rondell.itemHoveredClass).stop(!0).animate({opacity:1},this.rondell.fadeTime,this.rondell.funcEase)},b.prototype.onMouseLeave=function(){return this.object.removeClass(this.rondell.classes.hovered),this.animating||this.hidden?void 0:this.object.stop(!0).animate({opacity:this.objectAnimationTarget.opacity},this.rondell.fadeTime,this.rondell.funcEase)},b.prototype.showCaption=function(){return this.rondell.captionsEnabled&&null!=this.overlay?this.overlay.stop(!0).css({height:"auto",overflow:"auto"}).fadeTo(300,1):void 0},b.prototype.hideCaption=function(){var a;return this.rondell.captionsEnabled&&(null!=(a=this.overlay)?a.is(":visible"):void 0)?this.overlay.stop(!0).css({height:this.overlay.height(),overflow:"hidden"}).fadeTo(200,0):void 0},b.prototype.prepareFadeIn=function(){var a,b,c,d;return this.focused=!0,this.hidden=!1,d=this.sizeFocused.width,c=this.sizeFocused.height,this.lastObjectAnimationTarget=this.objectAnimationTarget,this.objectAnimationTarget={width:d,height:c,left:this.rondell.center.left-d/2,top:this.rondell.center.top-c/2,opacity:1},this.objectCSSTarget={zIndex:this.rondell.zIndex+this.rondell.maxItems,display:"block"},this.animationSpeed=this.rondell.fadeTime,this.icon&&(this.lastIconAnimationTarget=this.iconAnimationTarget,a=0,b=0,this.resizeable||(b=(this.rondell.itemProperties.sizeFocused.height-this.iconHeight)/2,a=(this.rondell.itemProperties.sizeFocused.width-this.iconWidth)/2,this.iconAnimationTarget.marginTop=b,this.iconAnimationTarget.marginLeft=a),this.rondell.cropThumbnails)?this.iconAnimationTarget={marginTop:b,marginLeft:a,width:d,height:c}:void 0},b.prototype.prepareFadeOut=function(){var b,c,d,e,f,g,h,i,j;return this.focused=!1,b=this.currentSlot,j=this.rondell.getRelativeItemPosition(b),f=j[0],g=j[1],e=this.rondell.funcDiff(g-this.rondell.currentLayer,this.rondell,b),g<this.rondell.currentLayer&&(e*=-1),d=this.sizeSmall.width*this.rondell.funcSize(e,this.rondell),c=this.sizeSmall.height*this.rondell.funcSize(e,this.rondell),i=this.rondell.zIndex-f,this.animationSpeed=this.rondell.fadeTime+this.rondell.itemProperties.delay*f,h={width:d,height:c,left:this.rondell.funcLeft(e,this.rondell,b)+(this.rondell.itemProperties.size.width-d)/2,top:this.rondell.funcTop(e,this.rondell,b)+(this.rondell.itemProperties.size.height-c)/2,opacity:0},this.objectCSSTarget={zIndex:i,display:"block"},f<=this.rondell.visibleItems?(h.opacity=this.rondell.funcOpacity(e,this.rondell,b),this.hidden=!1,this.icon&&(this.lastIconAnimationTarget=this.iconAnimationTarget,this.rondell.cropThumbnails&&(this.iconAnimationTarget={marginTop:(this.rondell.itemProperties.size.height-this.croppedSize.height)/2,marginLeft:(this.rondell.itemProperties.size.width-this.croppedSize.width)/2,width:this.croppedSize.width,height:this.croppedSize.height}),this.resizeable||(this.iconAnimationTarget={marginTop:(this.rondell.itemProperties.size.height-this.iconHeight)/2,marginLeft:(this.rondell.itemProperties.size.width-this.iconWidth)/2}))):this.hidden&&a.extend(this.objectCSSTarget,h),this.lastObjectAnimationTarget=this.objectAnimationTarget,this.objectAnimationTarget=h
},b.prototype.onAnimationFinished=function(){return this.animating=!1,this.focused?(this.object.addClass(this.rondell.classes.focused),this.rondell.hovering||this.rondell.alwaysShowCaption||this.rondell._onMobile()?this.showCaption():void 0):this.objectAnimationTarget.opacity<this.rondell.opacityMin?(this.hidden=!0,this.object.css("display","none")):(this.hidden=!1,this.object.css("display","block"))},b.prototype.runAnimation=function(a){if(null==a&&(a=!1),this.object.css(this.objectCSSTarget),!this.hidden){if(!a&&!this.iconAnimationTarget||!this.icon||!this.focused&&this.rondell.equals(this.iconAnimationTarget,this.lastIconAnimationTarget)||this.icon.stop(!0).animate(this.iconAnimationTarget,this.animationSpeed,this.rondell.funcEase),!a&&null==this.objectAnimationTarget||!this.focused&&this.rondell.equals(this.objectAnimationTarget,this.lastObjectAnimationTarget))return this.onAnimationFinished();if(this.animating=!0,this.object.stop(!0).animate(this.objectAnimationTarget,this.animationSpeed,this.rondell.funcEase,this.onAnimationFinished),!this.focused)return this.object.removeClass(this.rondell.classes.focused),this.hideCaption()}},b}()}(jQuery);